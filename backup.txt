import { mouseDown, mouseUp, decodeMorse, morseTimer, reset, consumeSpaceStatus, consumeSpaceStatusText} from './functions.js';

//variables for mousehold event
let MorsePrint = document.getElementById('input_morse');
let TextOutput = document.getElementById('textArea');
const startWriting = document.getElementById('startMorseWrite');
const writeMorse = document.getElementById('writeMorseButton');
  
startWriting.addEventListener('click', function() {
  morseTimer();

  let checkInterval = setInterval(() => {
   if (consumeSpaceStatus()) {
      MorsePrint.innerHTML += ' ';
      console.log('adding space morse');
    }

    else if (consumeSpaceStatusText()) {
      MorsePrint.innerHTML += '   ';
      console.log('adding space text');
    }
  }, 100);


writeMorse.addEventListener('mousedown', mouseDown);
writeMorse.addEventListener('mouseup', function () {
  let result = mouseUp();
  
  MorsePrint.innerHTML += result;
  TextOutput.innerHTML = decodeMorse(MorsePrint.value);
  reset();
});

  });








import { dictionary } from './morseList.js';
import { reverseDictionary } from './morseList.js';


//function to translate from morse to text
let decodeMorse = function(morseCode){
  // Your code here
  // You can use MORSE_CODE[morse]
  console.log(dictionary);
  //let arrayMorseWord = morseCode.split('   ');
  let wordArray = morseCode;
  let letters = "";
  let humanWord = "";
  let counter = 0;
  let finalWord;

  
  
  console.log("wordArray before first loop: " + wordArray + " its value: " + typeof wordArray)
  
  for (let letter = 0; letter < wordArray.length; letter ++) {
   console.log(wordArray[letter]);
      if (wordArray[letter] !== " ") {
        letters += wordArray[letter];
        console.log("letter extends: " + letters);
      } if (wordArray[letter] == " ") {
        counter ++;
        console.log("counter: " + counter);
        if(letters !== "") {
          console.log(dictionary[letters]);
        humanWord += dictionary[letters];
        console.log("human word: " + humanWord)
        letters = "";
          counter = 0;
        }
        
        }
        if (counter === 2) {
          console.log("we add a space in human word");
          humanWord += " ";
          counter = 0;
        }
        
    }
  
  if (letters !== "") {
    humanWord += dictionary[letters];
  }
  finalWord = humanWord.trim();
  
  console.log("final sentence: " + finalWord);
  
 return finalWord;
}


//function for translating text to morse
let encodeText = function(text) {
  let wordArray = text;
  let letters = "";
  let morse = "";
  for (let letter = 0; letter < wordArray.length; letter ++) {
   console.log(wordArray[letter]);
      if (wordArray[letter] !== ' ' && wordArray[letter].length == 1) {
        morse += reverseDictionary[wordArray[letter]];
        morse += " ";
        console.log("word extends: " + morse);
      } if (wordArray[letter] == " ") {
        console.log("founs space");
        morse += "   ";
      }
    }
return morse;
};


let pressTimer;
let writeTimer;
  let counter = 0;
  let Writecounter = 0;
  const timeBorder = 1;
  let finalValue;
  let mouseIsDown = false;

  //bool to check wether there will be space in morse text
  let spaceStatus = false;

  //bool to check wether morse code is three spaces = whitespace in norml text format
  let spaceStatusText = false;

  let consumeSpaceStatus = function () {
  if (spaceStatus) {
    spaceStatus = false;
    return true;
  }

};

let consumeSpaceStatusText = function () {
  if (spaceStatusText) {
    spaceStatusText = false;
    return true;
  }
  return false;
};


let reset = function() {
  finalValue = '';
};

 //counting function
let count = function() {
  counter ++;
  console.log(counter);
  return true;
};

let writeCount = function() {
  Writecounter ++;
  console.log(Writecounter);
  if (mouseIsDown == false) {
    
  
  if (Writecounter == timeBorder) {
    console.log('space ready');
    spaceStatus = true;
  };

  if (Writecounter == timeBorder + 2) {
    console.log('tripple space ready');
    spaceStatusText = true;
  };
  };
  return spaceStatus;
};

let morseTimer = function() {
  
  clearInterval(writeTimer);
  Writecounter = 0;
  writeTimer = setInterval(writeCount, 500);
};


//function when mouse down
let mouseDown = function() {
  mouseIsDown = true;
  pressTimer = setInterval(count, 100);
};


let mouseUp = function() {
    mouseIsDown = false;
  if (counter <= timeBorder) {
    finalValue = '.';
    console.log('final value: ' + finalValue);
  }
  else if (counter > timeBorder){
    finalValue = '-';
    console.log('final value: ' + finalValue);
  }
  
  counter = 0;
  clearInterval(pressTimer);
  clearInterval(writeTimer);
  morseTimer();
  return finalValue;
};



export { encodeText, decodeMorse, count, mouseDown, mouseUp, morseTimer, reset, consumeSpaceStatus, consumeSpaceStatusText}











